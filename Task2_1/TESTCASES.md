# Тест-кейсы для API микросервиса объявлений (Задание 2.1)

### Ключевые наблюдения по результатам исследования:
1.  **Найден критический баг:** Сервер позволяет создавать объявления с отрицательной ценой (`price < 0`), возвращая `200 OK`.
2.  **Неконсистентность API:** Ответ на успешное создание (`POST`) — это `{"status": "..."}`, в то время как ответы на получение (`GET`) возвращают полный JSON-объект.
3.  **Последовательная валидация:** При отсутствии нескольких полей, сервер сообщает об ошибке только для первого недостающего поля по порядку (`name` -> `price` -> `sellerID` -> `likes`...).

---

## Ручка: POST /api/1/item (Создать объявление)

### Позитивные
- **TC-1.1:** Успешное создание объявления со всеми валидными полями.
    - **Ожидаемый результат:** Статус-код `200 OK`. Тело ответа НАПРИМЕР:
      ```json
      {
          "status": "Сохранили объявление - 77992fe2-fa38-4f22-b2d8-bbcefae776b3"
      }
      ```

### Негативные
- **TC-1.2:** Создание объявления без обязательного поля `name`.
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "поле name обязательно",
              "messages": {}
          },
          "status": "400"
      }
      ```

- **TC-1.3:** Создание объявления без обязательного поля `price`.
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "поле price обязательно",
              "messages": {}
          },
          "status": "400"
      }
      ```

- **TC-1.4:**  Создание объявления без обязательного поля `sellerId`.
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "поле sellerID обязательно",
              "messages": {}
          },
          "status": "400"
      }
      ```

- **TC-1.5:** Создание объявления без обязательного объекта `statistics`.
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа (проверяется первое поле из `statistics`):
      ```json
      {
          "result": {
              "message": "поле likes обязательно",
              "messages": {}
          },
          "status": "400"
      }
      ```

- **TC-1.6:** Создание объявления с неверным типом данных в поле price (строка вместо числа).
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "",
              "messages": {}
          },
          "status": "не передано тело объявления"
      }
      ```

- **TC-1.7:** Создание объявления с отрицательной ценой (например, `"price": -100`).
    - **Ожидаемый результат:** Статус-код `400 Bad Request` с сообщением об ошибке.

- **TC-1.8:** Создание объявления со значением `likes` равным 0.
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа (проверяется первое поле из `statistics`):
      ```json
      {
          "result": {
              "message": "поле likes обязательно",
              "messages": {}
          },
          "status": "400"
      }
      ```

- **TC-1.9:** Создание объявления с нулевой ценой (`price: 0`).
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "поле price обязательно",
              "messages": {}
          },
          "status": "400"
      }
      ```
---

## Ручка: GET /api/1/item/{id} (Получить объявление по ID)

### Позитивные
- **TC-2.1:** Успешное получение ранее созданного объявления по его `id`.
    - **Ожидаемый результат:** Статус-код `200 OK`. Тело ответа НАПРИМЕР:
      ```json
      [
          {
              "createdAt": "2025-11-20 12:46:20.372614 +0300 +0300",
              "id": "77992fe2-fa38-4f22-b2d8-bbcefae776b3",
              "name": "Тестовое объявление",
              "price": 100,
              "sellerId": 111311,
              "statistics": {
                  "contacts": 2,
                  "likes": 2,
                  "viewCount": 2
              }
          }
      ]
      ```

### Негативные
- **TC-2.2:** Запрос объявления по несуществующему `id`.
    - **Ожидаемый результат:** Статус-код `404 Not Found`. Тело ответа:
      ```json
      {
          "result": {
              "message": "item 11111111-1111-1111-1111-111111111111 not found",
              "messages": null
          },
          "status": "404"
      }
      ```

- **TC-2.3:** Запрос объявления с `id` в невалидном формате (не UUID).
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "ID айтема не UUID: abc123",
              "messages": {}
          },
          "status": "400"
      }
      ```

---

## Ручка: GET /api/1/{sellerId}/item (Получить все объявления пользователя)

### Позитивные
- **TC-3.1:** Успешное получение списка из нескольких объявлений одного продавца.
    - **Ожидаемый результат:** Статус-код `200 OK`. Тело ответа НАПРИМЕР:
      ```json
      [
          {
              "createdAt": "2025-11-20 00:22:16.294801 +0300 +0300",
              "id": "1c1d9f0d-ac97-4de0-a00e-756ab3924953",
              "name": "Тестовое объявление",
              "price": 100,
              "sellerId": 111311,
              "statistics": { "contacts": 2, "likes": 2, "viewCount": 2 }
          },
          {
              "createdAt": "2025-11-20 12:45:07.961343 +0300 +0300",
              "id": "d493d36f-9db6-485b-8383-39ced1ceab5a",
              "name": "Ноутбук",
              "price": 150000,
              "sellerId": 111311,
              "statistics": { "contacts": 5, "likes": 10, "viewCount": 100 }
          }
      ]
      ```

- **TC-3.2:** Успешное получение пустого списка для пользователя без объявлений.
    - **Ожидаемый результат:** Статус-код `200 OK`. Тело ответа:
      ```json
      []
      ```

### Негативные
- **TC-3.3:** Запрос объявлений с `sellerId` в невалидном формате (строка вместо числа).
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "передан некорректный идентификатор продавца",
              "messages": {}
          },
          "status": "400"
      }
      ```

---

## Ручка: GET /api/1/statistic/{id} (Получить статистику по объявлению)

### Позитивные
- **TC-4.1:** Успешное получение статистики для ранее созданного объявления.
    - **Ожидаемый результат:** Статус-код `200 OK`. Тело ответа НАПРИМЕР:
      ```json
      [
          {
              "contacts": 2,
              "likes": 2,
              "viewCount": 2
          }
      ]
      ```

### Негативные
- **TC-4.2:** Запрос статистики по несуществующему `id` объявления.
    - **Ожидаемый результат:** Статус-код `404 Not Found`. Тело ответа:
      ```json
      {
          "result": {
              "message": "statistic 1c1d9f0d-ac97-4de0-a00e-756ab3924952 not found",
              "messages": null
          },
          "status": "404"
      }
      ```

- **TC-4.3:** Запрос статистики с `id` объявления в невалидном формате (не UUID).
    - **Ожидаемый результат:** Статус-код `400 Bad Request`. Тело ответа:
      ```json
      {
          "result": {
              "message": "передан некорректный идентификатор объявления",
              "messages": {}
          },
          "status": "400"
      }
      ```